<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>Admin</title>
  <link rel="stylesheet" href="../style.css">
</head>
<body>

<header><h2>Admin Panel</h2></header>
<div class="container" id="panel"></div>

<script src="../users.js"></script>
<script src="../session.js"></script>
<script src="../logs.js"></script>
<script src="../data.js"></script>

<script>
const user = getUser();
if (!user || user.role !== "admin") {
  alert("Acces interzis");
  location.href = "../";
}

let products = JSON.parse(localStorage.getItem("products"));
const panel = document.getElementById("panel");

panel.innerHTML = `
<h3>Produse</h3>
<input id="name" placeholder="Nume">
<input id="price" placeholder="Preț">
<textarea id="desc" placeholder="Descriere"></textarea>
<button onclick="add()">Adaugă</button>
<div id="list"></div>
`;

function render() {
  list.innerHTML = "";
  products.forEach((p,i)=>{
    list.innerHTML += `${p.name} - ${p.price}€
    <button onclick="del(${i})">X</button><br>`;
  });
}

function add() {
  products.push({
    name: name.value,
    price: price.value,
    description: desc.value,
    image: ""
  });
  localStorage.setItem("products", JSON.stringify(products));
  addLog("A adăugat produs " + name.value);
  render();
}

function del(i) {
  addLog("A șters produs " + products[i].name);
  products.splice(i,1);
  localStorage.setItem("products", JSON.stringify(products));
  render();
}

render();
</script>

</body>
</html>
